from __future__ import annotations

import logging

from homeassistant.const import Platform

LOGGER = logging.getLogger(__name__)

DOMAIN = "fluora_light"

CONF_NAME = "name"
CONF_HOSTNAME = "hostname"
CONF_PORT = "port"

DEFAULT_NAME = "Fluora Light"
DEFAULT_PORT = 6767

PLATFORMS: list[Platform] = [Platform.LIGHT, Platform.NUMBER]

BRIGHTNESS_HEX_FIRST = "2f557637614d46773550326c580000002c666900"
BRIGHTNESS_HEX_LAST = "0000000000"

POWER_ON_HEX = "2f5379594f5469586a51426a570000002c6969000000000100000000"
POWER_OFF_HEX = "2f5379594f5469586a51426a570000002c6969000000000000000000"

EFFECT_AUTO = "Auto"
EFFECT_RED = "Red"
EFFECT_ORANGE = "Orange"
EFFECT_GREEN = "Green"
EFFECT_BLUE = "Blue"
EFFECT_PURPLE = "Purple"
EFFECT_YELLOW = "Yellow"
EFFECT_WHITE = "White"
EFFECT_CUSTOM = "Custom"
EFFECT_PARTY = "Party"
EFFECT_CHILL = "Chill"
EFFECT_FOCUS = "Focus"
EFFECT_BEDTIME = "Bedtime"
EFFECT_AWAKEN = "Awaken"

COLOR_EFFECTS = [
    EFFECT_RED,
    EFFECT_GREEN,
    EFFECT_BLUE,
    EFFECT_YELLOW,
    EFFECT_ORANGE,
    EFFECT_PURPLE,
]
SCENE_EFFECTS = [EFFECT_PARTY, EFFECT_CHILL, EFFECT_FOCUS, EFFECT_BEDTIME, EFFECT_AWAKEN]

EFFECT_LIST = COLOR_EFFECTS + SCENE_EFFECTS + [EFFECT_AUTO, EFFECT_WHITE, EFFECT_CUSTOM]

AUTO_HEX = "2f697761614d6b567a4f66554d0000002c6969000000000000000000"
SCENE_HEX = "2f697761614d6b567a4f66554d0000002c6969000000000100000000"
MANUAL_HEX = "2f697761614d6b567a4f66554d0000002c6969000000000200000000"

PARTY_HEX = "2f457055775a41314753506a4f0000002c6969000000000000000000"
CHILL_HEX = "2f457055775a41314753506a4f0000002c6969000000000100000000"
FOCUS_HEX = "2f457055775a41314753506a4f0000002c6969000000000200000000"
BEDTIME_HEX = "2f457055775a41314753506a4f0000002c6969000000000300000000"
AWAKEN_HEX = "2f457055775a41314753506a4f0000002c6969000000000400000000"

RED_HEX = "2f5468576e787336356c30736a0000002c6669003f578e0000000000"
ORANGE_HEX = "2f5468576e787336356c30736a0000002c6669003f5a4f0000000000"
GREEN_HEX = "2f5468576e787336356c30736a0000002c6669003e69a30000000000"
BLUE_HEX = "2f5468576e787336356c30736a0000002c6669003eef800000000000"
PURPLE_HEX = "2f5468576e787336356c30736a0000002c6669003f37340000000000"
YELLOW_HEX = "2f5468576e787336356c30736a0000002c666900360b670000000000"

# Saturation payloads contain a 3-byte big-endian-like value encoded as 6 hex chars.
MIN_SATURATION_HEX = (
    "2f7936383755345a67796d736a0000002c666900" + f"{3932160:06x}" + "0000000000"
)
MAX_SATURATION_HEX = (
    "2f7936383755345a67796d736a0000002c666900" + f"{4160442:06x}" + "0000000000"
)

# Palette control routes (from device config dump)
HUE_ROUTE = "/ThWnxs65l0sj"
SATURATION_ROUTE = "/y687U4Zgymsj"

# The device's hue wheel is offset vs typical 0°=red.
# This value aligns HA "red" (0°) with the device's known red preset.
HUE_OFFSET = 0.842

# Saturation float range derived from MIN/MAX saturation payloads.
SATURATION_MIN = 0.0078125
SATURATION_MAX = 0.983306884765625

# Manual mode dashboard controls (from device config dump)
MANUAL_SPEED_ROUTE = "/Vd72e0D61BuM"
MANUAL_SIZE_ROUTE = "/Vd7XP0X61BuM"

SCENE_HEX_DICT = {
    EFFECT_PARTY: PARTY_HEX,
    EFFECT_CHILL: CHILL_HEX,
    EFFECT_FOCUS: FOCUS_HEX,
    EFFECT_BEDTIME: BEDTIME_HEX,
    EFFECT_AWAKEN: AWAKEN_HEX,
    EFFECT_AUTO: AUTO_HEX,
    EFFECT_RED: RED_HEX,
    EFFECT_ORANGE: ORANGE_HEX,
    EFFECT_GREEN: GREEN_HEX,
    EFFECT_BLUE: BLUE_HEX,
    EFFECT_PURPLE: PURPLE_HEX,
    EFFECT_YELLOW: YELLOW_HEX,
}
